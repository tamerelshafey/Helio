# خطة عمل المشروع وخريطة الطريق التقنية

هذه الوثيقة توضح التقنيات المستخدمة في بناء منصة **ONLY HELIO** ومراحل التطوير التي مر بها المشروع للوصول إلى بنيته الحالية القوية والقابلة للتطوير.

---

## 1. التقنيات المستخدمة (Technology Stack)

تم بناء المنصة باستخدام مجموعة من التقنيات الحديثة لضمان الأداء العالي، تجربة المستخدم الممتازة، وسهولة الصيانة.

### الواجهة الأمامية (Frontend)
-   **React 19:** المكتبة الأساسية لبناء واجهات المستخدم التفاعلية.
-   **TypeScript:** لإضافة أنواع ثابتة إلى JavaScript، مما يجعل الكود أكثر قوة وموثوقية.
-   **React Router v7:** لإدارة التنقل والمسارات داخل التطبيق (Client-Side Routing).
-   **Tailwind CSS:** إطار عمل CSS يعتمد على الأدوات المساعدة (Utility-First) لتصميم واجهات سريعة ومخصصة.

### إدارة البيانات والحالة (Data & State Management)
-   **Tanstack Query (React Query) v5:** مكتبة قوية لإدارة حالة الخادم (Server State)، التخزين المؤقت (Caching)، إعادة جلب البيانات، وتوفير تجربة مستخدم سلسة أثناء تحميل البيانات.
-   **React Context API:** لإدارة الحالات العامة البسيطة مثل اللغة الحالية (Language) والمستخدم المسجل دخوله (Auth).

### النماذج (Forms)
-   **React Hook Form:** لإدارة النماذج والتحقق من صحة البيانات بكفاءة عالية وأداء ممتاز.

### الذكاء الاصطناعي (Artificial Intelligence)
-   **Google Gemini API:** تم استخدامها لإنشاء "البحث الذكي" في صفحة العقارات، حيث يتم تحليل استعلامات اللغة الطبيعية للمستخدم وتحويلها إلى فلاتر بحث منظمة.

### التحليلات والتقارير (Analytics & Reporting)
-   **Chart.js & react-chartjs-2:** لإنشاء الرسوم البيانية التفاعلية في لوحات التحكم.
-   **jsPDF & jspdf-autotable:** لتوليد وتصدير التقارير بصيغة PDF مباشرة من المتصفح.

### أدوات التطوير والبناء (Development & Build Tools)
-   **Vite:** أداة بناء حديثة وسريعة جدًا توفر تجربة تطوير ممتازة مع تحديثات فورية (Hot Module Replacement).

---

## 2. خريطة عمل المشروع (Project Roadmap)

مر المشروع بعدة مراحل تطوير استراتيجية لتحسين بنيته وأدائه.

### ✅ المرحلة الأولى: التأسيس والبنية الأولية
-   **الهدف:** بناء الميزات الأساسية ووضع هيكل مبدئي للمشروع.
-   **الإجراءات:**
    -   إعداد المشروع باستخدام Vite + React + TypeScript.
    -   إنشاء الصفحات الرئيسية العامة (الرئيسية، العقارات، تواصل معنا).
    -   استخدام بنية ملفات مسطحة (Flat Structure) داخل مجلد `components`.
    -   محاكاة الـ API باستخدام ملفات بيانات ثابتة في مجلد `data`.

### ✅ المرحلة الثانية: إعادة الهيكلة الكبرى (The Big Refactor)
-   **الهدف:** تحسين قابلية الصيانة والتوسع عبر تطبيق بنية تنظيمية أفضل.
-   **الإجراءات:**
    1.  **الانتقال إلى بنية قائمة على الميزات (Feature-Based Structure):** تم نقل المكونات إلى مجلدات متخصصة (`properties`, `admin`, `home`, `shared`, `ui`) لتسهيل الوصول إليها وفصل الاهتمامات.
    2.  **مركزية خدمات البيانات:** تم إنشاء مجلد `services` ليكون المصدر الوحيد لجلب البيانات، مما يفصل منطق البيانات عن مكونات العرض.
    3.  **إنشاء مكتبة مكونات UI:** تم إنشاء مجلد `components/ui` ليحتوي على مكونات أساسية قابلة لإعادة الاستخدام (Button, Card, Input, Modal) لضمان اتساق التصميم.

### ✅ المرحلة الثالثة: تحسين الأداء وإدارة الحالة المتقدمة
-   **الهدف:** جعل التطبيق أسرع وأكثر استجابة، وتحسين طريقة التعامل مع بيانات الخادم.
-   **الإجراءات:**
    1.  **تكامل Tanstack Query:** استبدال `useState` و `useEffect` لجلب البيانات بـ `useQuery`، مما أضاف ميزات قوية مثل التخزين المؤقت، إعادة الجلب التلقائي، وإدارة حالات التحميل والأخطاء بكفاءة.
    2.  **التقسيم الاستراتيجي للكود (Code Splitting):** تم استخدام `React.lazy` و `Suspense` لتقسيم التطبيق إلى أجزاء منطقية (`PublicRoutes`, `AdminRoutes`, `PartnerRoutes`). الآن، لا يتم تحميل كود لوحات التحكم إلا عند الحاجة إليه، مما يقلل بشكل كبير من حجم الحزمة الأولية.
    3.  **التحسين باستخدام `React.memo`:** تم تغليف المكونات التي تتكرر كثيرًا (مثل `PropertyCard` و `Header`) بـ `React.memo` لمنع إعادة العرض غير الضرورية وتحسين أداء العرض.

### ✅ المرحلة الرابعة: الميزات المتقدمة والصقل النهائي
-   **الهدف:** إضافة وظائف متقدمة وتحسين تجربة المستخدم بشكل عام.
-   **الإجراءات:**
    1.  **بناء لوحات التحكم المتقدمة:** تطوير لوحات تحكم متخصصة للمسؤولين والشركاء مع ميزات مثل إدارة المحتوى، التحليلات، إدارة المستخدمين، والتحكم في الإعلانات.
    2.  **تكامل Gemini API:** بناء ميزة "البحث الذكي" لتحليل استعلامات المستخدمين.
    3.  **صقل الواجهة (UI Polish):** إضافة تأثيرات بصرية بسيطة (Micro-interactions) وانتقالات لجعل التفاعل مع الموقع أكثر سلاسة واحترافية.
    4.  **التوثيق:** إنشاء ملف `README.md` وملف `DEVELOPMENT_PLAN.md` (هذه الوثيقة) لتوثيق المشروع بشكل كامل.

---

## 3. خطة مستقبلية: الترحيل إلى Next.js (مؤجل حالياً)

**ملاحظة:** بناءً على المتطلبات الحالية، تم تأجيل خطة الترحيل إلى Next.js للتركيز على استقرار ونشر النسخة الحالية القائمة على Vite. يتم الاحتفاظ بالخطوات التالية كمرجع مستقبلي.

بناءً على الرؤية التقنية المحددة، هذه هي خارطة الطريق التنفيذية المقترحة لتحويل المشروع من تطبيق React الحالي إلى بنية Next.js متكاملة.

### المرحلة 0: التأسيس وإعداد المشروع (Foundation & Project Setup)
1.  **إنشاء مشروع Next.js:** إنشاء مشروع Next.js 14+ جديد باستخدام App Router. `npx create-next-app@latest only-helio-next` (مع اختيار TypeScript, Tailwind CSS, ESLint, و Src Directory).
2.  **ربط المشروع مع Vercel:** إنشاء مشروع جديد على Vercel، وربطه بمستودع GitHub جديد، وإعداد متغيرات البيئة (`.env.local`) للمفاتيح اللازمة.
3.  **هيكلة المشروع:** تنظيم مجلد `src` ليناسب بنية Next.js: `app/` للمسارات، `components/` للمكونات، `lib/` للدوال المساعدة وقاعدة البيانات، و `prisma/` لمخطط قاعدة البيانات.

### المرحلة 1: بناء قاعدة البيانات وواجهات API (Database & API Layer)
1.  **إعداد قاعدة بيانات Vercel Postgres:** إنشاء قاعدة بيانات Postgres جديدة من لوحة تحكم Vercel وإضافة رابط الاتصال إلى متغيرات البيئة.
2.  **تحديد مخطط قاعدة البيانات باستخدام Prisma:** تثبيت Prisma ORM وترجمة أنواع TypeScript الحالية من `types.ts` إلى ملف `schema.prisma`.
3.  **ملء قاعدة البيانات بالبيانات الأولية:** كتابة سكربت (`/scripts/seed.ts`) لقراءة البيانات من ملفات `/data/*.ts` الحالية وإضافتها إلى قاعدة البيانات الجديدة باستخدام Prisma.
4.  **بناء مسارات API:** إنشاء Route Handlers في Next.js داخل مجلد `app/api/` لتحل محل الوظائف الموجودة في مجلد `services/` الحالي، مع استخدام Prisma للتفاعل مع قاعدة البيانات.

### المرحلة 2: ترحيل الواجهة الأمامية وربطها (Frontend Migration & Connection)
1.  **ترحيل المكونات:** نقل مكونات React الحالية إلى الهيكل الجديد (`/components/ui`, `/components/shared`, etc.).
2.  **استخدام App Router للتنقل:** تحويل مسارات `react-router-dom` إلى نظام المسارات القائم على الملفات في Next.js (e.g., `app/properties/[id]/page.tsx`).
3.  **جلب البيانات:** استبدال استدعاءات `useQuery` باستدعاءات `fetch` لمسارات API الجديدة. الاستفادة القصوى من **Server Components** لجلب البيانات الأولية وتحسين الأداء و SEO.

### المرحلة 3: المصادقة والصلاحيات (Authentication & Authorization)
1.  **تكامل Auth.js (NextAuth):** إعداد NextAuth لتسجيل الدخول عبر البريد الإلكتروني وكلمة المرور باستخدام Credentials Provider.
2.  **حماية المسارات:** استخدام Middleware في Next.js (`middleware.ts`) لحماية مسارات لوحات التحكم (`/admin`, `/dashboard`).
3.  **إدارة جلسات المستخدم:** استبدال `AuthContext` المخصص بـ `SessionProvider` و `useSession` من NextAuth.
4.  **ترحيل صفحات تسجيل الدخول والتسجيل:** إعادة بناء الصفحات للتفاعل مع واجهات API الخاصة بـ NextAuth.

### المرحلة 4: تكامل الخدمات الخارجية (External Services Integration)
1.  **استخدام Cloudinary للصور:** إنشاء مسار API آمن في Next.js يعمل كـ proxy للتفاعل مع Cloudinary. تحديث النماذج لرفع الصور مباشرة إلى Cloudinary.
2.  **استخدام Resend للبريد الإلكتروني:** إنشاء دالة مساعدة في `/lib/email.ts` تستخدم Resend API، ودمجها في مسارات API ذات الصلة (مثل إرسال بريد ترحيبي بعد الموافقة على طلب الشراكة).

### المرحلة 5: النشر والإطلاق (Deployment & Go-Live)
1.  **الاختبار النهائي:** إجراء اختبار شامل (End-to-End) على بيئة Vercel التجريبية (Preview Deployment).
2.  **إعداد النطاق و DNS:** في لوحة تحكم Hostinger، تحديث سجلات DNS لنطاق `onlyhelio.com` لتوجيهها إلى Vercel.
3.  **النشر على البيئة الإنتاجية:** دمج الكود النهائي الذي تم اختباره في الفرع الرئيسي `main`، مما سيؤدي إلى النشر التلقائي على Vercel.
4.  **المراقبة:** استخدام Vercel Analytics لمراقبة حركة المرور على الموقع، الأداء (Core Web Vitals)، وأي أخطاء تحدث في وقت التشغيل.